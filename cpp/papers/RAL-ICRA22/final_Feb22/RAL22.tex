%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%2345678901234567890123456789012345678901234567890123456789012345678901234567890
%        1         2         3         4         5         6         7         8

\documentclass[letterpaper, 10 pt, journal, twoside]{ieeetran}  % Comment this line out if you need a4paper

%\documentclass[a4paper, 10pt, conference]{ieeeconf}      % Use this line for a4 paper

\IEEEoverridecommandlockouts                              % This command is only needed if 
                                                          % you want to use the \thanks command

%\overrideIEEEmargins                                      % Needed to meet printer requirements.

%In case you encounter the following error:
%Error 1010 The PDF file may be corrupt (unable to open PDF file) OR
%Error 1000 An error occurred while parsing a contents stream. Unable to analyze the PDF file.
%This is a known problem with pdfLaTeX conversion filter. The file cannot be opened with acrobat reader
%Please use one of the alternatives below to circumvent this error by uncommenting one or the other
%\pdfobjcompresslevel=0
%\pdfminorversion=4

% See the \addtolength command later in the file to balance the column lengths
% on the last page of the document

\usepackage{graphics} % for pdf, bitmapped graphics files
\usepackage{epsfig} % for postscript graphics files
\usepackage{mathptmx} % assumes new font selection scheme installed
\usepackage{times} % assumes new font selection scheme installed
\usepackage{amsmath} % assumes amsmath package installed
\usepackage{amssymb}  % assumes amsmath package installed
%\usepackage{amsthm}
\usepackage{bm}
\usepackage{mathrsfs}
\usepackage{color}
\usepackage{cite}
\usepackage{threeparttable}

\usepackage{multirow}
\usepackage{bigdelim}

\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage{algpseudocode}

\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{makecell}

\usepackage[hyphens]{url}
\usepackage{hyperref}

\usepackage{verbatim}

%\usepackage[all]{xy}

% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}


\newtheorem{theorem}{Theorem}[section]
\newtheorem{definition}{Definition}[section]
\newtheorem{lemma}{Lemma}[section]
\newtheorem{remark}{Remark}[section]
\newtheorem{corollary}{Corollary}[section]
\newtheorem{notation}{Notation}[section]
\newtheorem{problem}{Problem}[section]

\floatname{algorithm}{Algorithm}
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}

\title{
Optimal Task-Space Tracking with Minimum Manipulator Reconfiguration
}


\author{Tong Yang$^{1}$~\IEEEmembership{Student Member,~IEEE}, Jaime Valls Miro$^2$~\IEEEmembership{Member,~IEEE}, \\Yue Wang$^{1}$~\IEEEmembership{Member,~IEEE} and Rong Xiong$^1$~\IEEEmembership{Member,~IEEE}
\thanks{Manuscript received September 9, 2021; Revised December 18, 2021; Accepted February 11, 2022.}
\thanks{This paper was recommended for publication by Editor Stephen J. Guy upon evaluation of the Associate Editor and Reviewers' comments. 
This work was supported by the National Nature Science Foundation of China under Grant 62173293. \textit{(Corresponding author: Yue Wang and Rong Xiong.)}}
\thanks{$^1$Tong Yang, Yue Wang, and Rong Xiong are with the State Key 
Laboratory of Industrial Control and Technology, Zhejiang University, P.R. China. 
(e-mail: {\tt\footnotesize tong.yang@zju.edu.cn}; {\tt\footnotesize ywang24@zju.edu.cn}; {\tt\footnotesize rxiong@zju.edu.cn}).
}
\thanks{$^2$Jaime Valls Miro is with the Robotis Institue at the University of Technology Sydney (UTS:RI), Sydney, Australia.

(e-mail: {\tt\footnotesize jaime.vallsmiro@uts.edu.au}).}
\thanks{Digital Object Identifier (DOI): see top of this page.}
}

\markboth{IEEE Robotics and Automation Letters. Preprint Version. Accepted February 2022}
{Yang \MakeLowercase{\textit{et al.}}: Optimal Task-Space Tracking with Minimum Manipulator Reconfiguration}

\begin{document}

\maketitle
%\thispagestyle{empty}
%\pagestyle{empty}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{abstract}
An optimal solution to the task-space tracking problem using a non-redundant manipulator is proposed. This is a recurring occurrence in automated manufacturing settings, 
e.g. welding, deburring, painting, or quality control inspections. 
Given a pre-defined path for the end-effector to follow, there may not exist a joint-space continuous solution for task-space tracking when the non-linear manipulator kinematics and collision avoidance with obstacles in the workcell are considered. This introduces undesirable manipulator reconfigurations where the end-effector is required to deviate temporarily from the pre-defined path. 
The unwanted motion results in pausing task-space tracking, often incurring not only ineffective time and energy demands but potentially compromising the quality of the task at hand due to the additional discontinuities. 
An algorithm is proposed that provides a globally optimal perspective to the choice of suitable joint-space connected segments so that the minimum number of manipulator reconfigurations during task-space tracking is guaranteed.  By carefully selecting the inverse kinematic solutions, all sequences ensuring minimum reconfigurability are proven collected by Dynamic Programming. 
Moreover, a faster greedy strategy is suggested to increase the computational efficiency of the tracker whilst still preserving global optimality and completeness. 
The effectiveness of the proposed algorithm is validated against traditional sampling-based solvers in simulation and illustrated on challenging real-world tracking experimentation with a Universal Robotics manipulator and a curved-surface object, depicted also in an accompanying video. 
An open-source implementation has also been provided for the benefit of the robotics community. 
\end{abstract}

\begin{IEEEkeywords}
Intergrated Planning and Control, Motion Control, Manipulation Planning
\end{IEEEkeywords}

\IEEEpeerreviewmaketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}


\begin{figure}[t]
\centering
\includegraphics[width=0.48\textwidth]{figures/fig1/fig1_2}\label{fig:zerosolution}
\caption{Illustration of a welding task using a non-redundant manipulator. The intersecting curve of two cylinders, as well as the EE pose during the task is assumed well-defined. 
At the end of the first segment of continuous tracking (depicted in green), the wrist would hit the forearm if the manipulator moved further along the path. thus, in order to continue tracking the desired path, the manipulator must adopt a different configuration pose, in this case the wrist-unflipped pose is shown for illustration.}
\label{fig:demo1}
\vspace{-0.4cm}
\end{figure}

\IEEEPARstart{T}he task-space non-revisiting tracking problem (TNTP) of a manipulator~\cite{Liang2010Adaptive} is a fundamental module that appears often in real-world applications, e.g.  welding~\cite{Norberto2003Welding}, inspection~\cite{Nakhaeinia2013Trajectory}~\cite{Simetti2016Underwater} or other general maintenance duties~\cite{Simetti2016Underwater}. 
In these applications, the task-space path for a manipulator equipped with the appropriate tool is generally pre-defined~\cite{Chen2019Synchronization}, and the problem is to generate a valid manipulator joint-space trajectory ensuring the end-effector (EE)  visits each point on the task-space path in order, and exactly one time~\cite{Janiak2017Motion}. 
However, a continuous singularity-free joint-space trajectory may be impeded by the manipulator kinematic constraints, and the motion made even more restricted by the obstacles present in the environment. As such the manipulator may be forced to undertake joint-space reconfigurations resulting in the EE departing from the pre-assigned path. 
The reconfiguration detour often induces not only unwelcome time and energy costs from an efficiency standpoint, but also imposes undesirable discontinuities that may have severe effects in the end results of the task at hand, e.g. during welding or painting.  The problem is further compounded by factors such as (a) clutter in the operating envelope, (b) complex traversal paths, and (c) lack of redundancy in the manipulator's kinematic chain. In all these common eventualities, joint-space motion is more likely truncated, thus rarely producing fully continuous joint-space trajectories for a pretended task-space path. More critically perhaps, there is no known mechanism to guarantee path lift-off optimality during the planning phase. 




An illustration of the TNTP problem applied to a figurative welding task is depicted in Fig.~\ref{fig:demo1}. Let the task-space path be the intersected curve between the two cylinders. 
To trace the path section closer to the manipulator base (EE path shown in green), the manipulator adopts the wrist-flipped configurations. 
However, there is limited reachability for the manipulator under this configuration in the far side of the path (EE tracking shown in blue in the bottom row, traversed later), as such the manipulator must readjust its pose and choose to adopt a wrist-unflipped configuration. During the rearrangement, an undesirable motion of the EE path (shown in black) is introduced, together with the inevitable suspension of the path tracking at the point of take-off and re-landing. 
Finally, the manipulator is able to finish the tracking of the desired path with one pose reconfiguration (the latter part of EE tracking is depicted in blue). 

A key observation in this setting is the natural discontinuity between different inverse kinematics (IK) solutions of the same EE pose when discarding singular configurations: between an 
elbow-up configuration and an elbow-down configuration there must be a transition through a singular elbow-straight configuration, the neighbourhood of which is generally 
disregarded during planning~\cite{Mayorga1988Singularities}, particularly in industrial settings given a manipulator's controller ability to deal effectively with perturbations along singular dimensions~\cite{Xu2015Singularity}. 
As such, only the pairwise connectedness of valid IK solutions for consecutive EE waypoints needs consideration, and the problem of minimising the number of manipulator 
reconfigurations can be transformed into an efficient model to select connected pairs of IK solutions (as will be described in further detail in Section~\ref{section:modelling}.) 

In this paper, we discuss the optimal solution to the TNTP of non-redundant manipulators. Optimality in this context translates to the minimum number of EE deviations from the pre-defined path. The problem constitutes a generalisation of the classic task-space tracking problem seeking a joint-space continuous trajectory, essentially a zero-reconfiguration solution to the TNTP, if it exists. Whilst for the cases where no zero-reconfiguration solution prevails, the assignment can be regarded as ``failed" by existing (sampling) algorithms. However, the outcome via the proposed TNTP optimal scheme can now guarantee a solvable min-reconfiguration solution regardless. The contributions of this paper can be summarised as: 
\begin{enumerate}
\item A generalisation of the manipulator task-space tracking task into a TNTP with minimum reconfigurations, which is shown solvable. 
\item A computationally tractable solver. 
\item The open-sourcing$^1$ of the algorithm.
\end{enumerate}


\begin{figure}[t]
\centering
\subfigure[]{
\includegraphics[width=0.21\textwidth]{figures/sing_a_2}\label{fig:sing:a}
}
\subfigure[]{
\includegraphics[width=0.21\textwidth]{figures/sing_b_2}\label{fig:sing:b}
}
\caption{Demonstration of the joint-space structure near singularities. The adoption of a manipulability measure implicitly forms a gap between disjointed sets of non-singular configurations. (a) A suitable choice of joint-space connectivity measure $\epsilon_{\rm cont}$ will provide correct judgment of connectedness between configurations (b) An unsuitable choice of $\epsilon_{\rm cont}$, where configurations from different sets might be mistakenly regarded as continuous. }\label{fig:sing}
\vspace{-0.3cm}
\end{figure}



The remainder of this paper is organised as follows~\footnote{A video illustrating the concepts hereby described, together with an opensource implementation, can be found here: \\\url{https://github.com/ZJUTongYang/minReconfigTaskSpaceTracking}}.  
%~\footnote{A video illustrating the concepts hereby described can be found here: \\\url{https://youtu.be/uaO--IFExqk}}
Section~\ref{section:related_work} reviews and contextualised the problem within the existing literature. 
Section~\ref{section:modelling} shows that the optimal non-redundant TNTP solution can be transformed into an optimal assignment of joint-space IK solutions. 
Section~\ref{section:solution} proposes a solver of the non-redundant TNTP, including a detailed algorithmic diagram, guaranteeing completeness and the uncovering of all the optimal solutions. 
Experimental results from simulations and on an actual non-redundant manipulator are collected in Section~\ref{section:experiments}, with final concluding remarks gathered in Section~\ref{section:conclusion}.  



\section{Related Work}\label{section:related_work}
The task-space tracking problem of a robot manipulator is an established research topic in the literature. Given a task-space path, the valid non-singular manipulator inverse kinematic (IK) solutions~\cite{Lavalle2006Planning} have been observed to form constrained subsets of the manipulator joint-space. 
When the manipulator transits between disjointed sets, the joint-space trajectory connecting configurations from disjointed sets will transition through at a singular state, in all likelihood making the end-effector veer off the pre-defined path, thus incurring an undesirable~\textit{pose reconfiguration}. 

Existing algorithms focus on a local trajectory generation for task-space tracking, i.e., given the manipulator's current configuration with the EE docked on the pre-defined path at a given orientation, generate a control strategy for each manipulator joint such that the EE moves along the path. 
Redundancy of the manipulator has generally been assumed~\cite{Egeland1987Task} so that there exists an ample set of joint-space continuous configurations for continuous task-space tracking, among which valid singular configurations also exist to bridge non-singular configurations~\cite{Porta2012Randomized}. 
Since the algorithms only need to locally generate an instant motion, they are more effectively referred to as ``task-space controllers''~\cite{Xian2004Task}. 
When no local continuous tracking motion can be found, a joint-space path planner will be adopted to find an unrestricted motion towards a configuration ensuring the EE visiting the next task-space point. 

However, the structure of valid IK configurations becomes further scattered when the manipulator is non-redundant~\cite{Mayorga1987Singularities}, with obstacles in the environment compounding this condition~\cite{Khatib1986Real}, since each connected set of valid IK solutions has only the same dimension as its task-space preimage (e.g., a curve in 6D space as is the case here). Furthermore, no valid singularity exists for possible utilisation: a non-redundant manipulator in a singular state means it has lost the ability to dispense with perturbations imposed on the EE. As a result, a relatively sizeable task-space path is unlikely to find a continuous joint-space trajectory via traditional task-space controllers, and the manipulator will have to resort to adopting frequent pose reconfigurations during tracking. 

More recent existing works~\cite{Yang2020Cellular}~\cite{Yang2020Nonrevisiting} have proposed cellular decomposition and graph theory in solving the optimal surface coverage task, also explicitly considering the joint-space connectivity of IK solutions to visit different task-space points. 
The nature of the surface cell data makes these proposed solvers exponential. 
In contrast, the work proposed in this manuscript focuses on the more persistent tracking problem, where the computational efficiency for possible real-time applications needs to be carefully considered. Given the reduced dimensionality of the problem, a dynamic programming (DP) approach with an efficient greedy strategy can thus be adapted to reveal a globally optimal and complete solution. 


\section{Problem Modelling}\label{section:modelling}
In this section, the non-redundant manipulator TNTP is modelled. The commonly utilised ``planning-controlling" scheme is adopted to tackle the problem. During the planning stage, 
and subject to a given task-space path, a joint-space collision-free path is constructed, where consecutive configurations are ``close" enough such that their connectedness can be guaranteed. 
Subsequently, during the control stage, joint-space waypoints are interpolated and assigned suitable reaching times and joint velocities. 
The focus of this work is on the planning stage, where the manipulator IK relation is not one-to-one but one-to-many~\cite{Lavalle2006Planning}. 
As such, selecting one from all valid IK solutions for each task-space waypoint becomes the fundamental problem. And the objective is to do it in a way that reconfigurations are minimised, and guaranteed at the planning stage. 
The discussion about control is assumed and outside the scope of the work. 
A table of notations is provided in Table~\ref{tab:notations}.


\begin{table}
\begin{center}
\caption{List of Notations}
\label{tab:notations}
\begin{tabular}{ c | c }
\hline
Symbol & Meaning\\
\hline
\hline
$N$ & number of task-space waypoints\\
\hline
$\gamma$ & task-space path\\ 
\hline
$c(i, a_i)$ & the $a_i$-th configuration to visit pose $\gamma_i$\\
\hline
$D(i, a_i)$ & the valid robot state corresponding to $c(i, a_i)$\\
\hline
$S(j_1, \cdots, j_N)$ & a sequence of configurations for all task-space poses\\
\hline
$g(S(\cdots))$ & the number of reconfigurations in the given sequence\\
\hline 
\end{tabular}
\end{center}
\vspace{-0.3cm}
\end{table}

\subsection{Task-Space Discretisation and Valid Manipulator States}
Let the non-redundant TNTP problem be discussed in the ordinary 3D tracking scenario, where the manipulator is 6 DoF. 
The task-space path to be tracked is parameterised by a function curve $\gamma(t), t\in [0, 1]$ where each point $\gamma(t)$ is a 3D pose of the manipulator EE. 
If there are multiple intermediate stations for the EE to visit in order, we use a cubic interpolation to generate a continuous curve. 
Then, a suitable number (say $N$) of points are sampled from the curve, and we get a series of 3D EE poses $\gamma_i = \gamma(\frac{i-1}{N-1}), 1\leq i\leq N$. 
For each point $\gamma_i$, knowing the manipulator kinematics, the manipulability constraints~\cite{yoshikawa1990translational}, and the obstacles in the surrounding environment, a set of valid IK solutions are collected, denoted by $\{c(i, a_i)\}_{1\leq a_i\leq A_i}$ where $A_i$ denotes the number of valid IK solutions for visiting point $\gamma_i$. 
The manipulability constraint filters all singularities, which also excludes a neighbouring set of nonsingular configurations of the singularities and thus forms a non-zero width gap between disjointed sets of non-singular configurations. 
See Fig.~\ref{fig:sing} for an illustration.
If two non-singular configurations are joint-space connectable only by visiting singularities, as long as we set a small distance measure $\epsilon_{\rm cont}$ as shown in Fig.~\ref{fig:sing:a}, they will not be mistakenly regarded as connectable configurations. 
However, note that the width of the gap is implicit, so there does not exist an explicit formula for $\epsilon_{\rm cont}$. How to choose a suitable $\epsilon_{\rm cont}$ is to be presented in the next paragraph. 


For each valid manipulator configuration $c(i, a_i)$ we assign a state $D(i, a_i)$ as follows: 
For the first EE pose $\gamma_1$, let $\{D(1, a_1)\}_{1\leq a_1\leq A_1}$ be distinct numbers, such as $1, \cdots, A_1$. 
For the $i$-th ($2\leq i\leq N$) EE pose, we match $\{c(i, a_i)\}_{1\leq a_i\leq A_i}$ to the IK solutions of previous point $\{c(i-1, a_{i-1})\}_{1\leq a_{i-1}\leq A_{i-1}}$ whose state $\{D(i-1, a_{i-1})\}_{1\leq a_{i-1}\leq A_{i-1}}$ have been assigned. 
\begin{enumerate}
\item If $c(i, a_i)$ is joint-space continuous to a previous configuration $c(i-1, a_{i-1})$, then $D(i, a_i) = D(i-1, a_{i-1})$.
\item If $c(i, a_i)$ is not connectable to any configuration in $\{c(i-1, a_{i-1})\}_{1\leq a_{i-1}\leq A_{i-1}}$,  $D(i, a_i)$ is assigned a new state different from all existing states. 
\item If $c(i, a_i)$ is connectable to multiple IK solutions of the previous point, this indicates that different IK solutions of the same task-space pose are connectable without visiting singularities. This is a wrong judgment because of inappropriate waypoints selection and a too coarse joint-space connectivity measure. See Fig.~\ref{fig:sing:b} for an illustration. Then the task-space should be re-sampled with a higher resolution, the connectivity measure should be set smaller, and all above-mentioned processes need to be re-done. 
\end{enumerate}


\subsection{The Task-Space Non-Revisiting Problem (TNTP)}

After all configurations are assigned a state, each task-space point has a set of possible states, $D(i)\triangleq \{D(i, a_i)\}_{1\leq a_i\leq A_i}$. 
Note that here we have assumed the non-nullity of $D(i)$, as if a task-space point is unreachable by any manipulator configuration, the TNTP problem is essentially divided into two sub-TNTP problems with the truncated task-space path segments. 
So the TNTP problem is finally transformed to the optimal design of state for each task-space point. 
A valid joint-space trajectory is a sequence of joint-space configurations, which can be represented by a vector of states,
\begin{equation}
S(j_1, j_2, \cdots, j_N) \triangleq [D(1, j_1), \cdots, D(N, j_N)],\ 1\leq j_i\leq A_i
\end{equation}
and the cost is defined by the number of switches of states, 
\begin{equation}\label{equ:cost}
g\left(S(j_1, \cdots, j_N)\right) \triangleq \sum\limits_{i = 1}^{N-1}\#\left\{D(i, j_i)\neq D(i+1, j_{i+1})\right\}
\end{equation}
The optimal solution to the TNTP problem is to find all admissible sequences of configurations such that the cost is the globally minimum, 
\begin{equation}
\begin{aligned}
S^*(j_1, j_2, \cdots, j_N) = &\mathop{\rm argmin}\limits_{[j_1, \cdots, j_N]}~g(S(j_1, \cdots, j_N))\\
s.t.~~~~ &1\leq j_i\leq A_i,\ i = 1, \cdots, N
\end{aligned}
\end{equation}


%<ty> The algorithmic diagram is too long so we have to use [H] option. So we adjust the position of the diagram after we finish wording. 

\begin{algorithm}[H]
    \caption{Non-redundant TNTP Solver}\label{alg:1}
    \begin{algorithmic}[1]
        \Require Task-space path $\gamma$, obstacles in environment $\{O\}$, manipulator kinematics and collision model, manipulability constraint $\epsilon_{\rm sing}$, configuration connectedness measure $\epsilon_{\rm cont}$
        \Ensure All optimal joint-space trajectories 
\State //Select task-space points for IK calculation
\State $\{\gamma_i\}_{1\leq i\leq N} \leftarrow \gamma(\frac{i-1}{N-1}), 1\leq i \leq N$
\State //Calculate valid IK solutions for each point
\For{$1\leq i\leq N$}
\State $\{c(i, a_i)\}_{1\leq a_i\leq A_i}\leftarrow$ calculateValidIK($\gamma_i$)
\State $D(i, a_i) = -1, 1\leq a_i\leq A_i$
\EndFor
\State $\{D(i, a_i)\}_{\substack{1\leq i\leq N\\1\leq a_i\leq A_i}}\leftarrow $assignJointState($\{c(i, a_i)\}_{\substack{1\leq i\leq N\\1\leq a_i\leq A_i}}$)
\State $P =\{[0, \cdots, 0]\}, \tilde{P} = \varnothing$ // preserved solutions
\For{$1\leq i\leq N$}
\State //In the $i$-th stage
\For{each solution $S(a_1, \cdots, a_{i-1}, 0, \cdots, 0)$ in $P$}
\If{$\exists j_i, D(i, j_i) = D(i-1, a_{i-1})$}
\State // Greedy Strategy
\State create $p = S(a_1, \cdots, a_{i-1}, a_{i-1}, 0, \cdots, 0)$
\State push $p$ into $G(i, a_{i-1})$
\Else
\For{$1\leq j_i\leq A_i$}
\State create $p = S(a_1, \cdots, a_{i-1}, j_i, 0, \cdots, 0)$
\State push $p$ into $G(i, j_i)$
\EndFor
\EndIf
\EndFor
\For{$1\leq j_i\leq A_i$}
\State preserve only least-cost elements in $G(i, j_i)$
\State push $G(i, j_i)$ into $\tilde{P}$
\EndFor
\State $P \leftarrow \tilde{P}$
\EndFor
\State //All optimal solutions have been collected in $P$
\For{each element in $P$}
\State collect $\{c(i, a_i)\}_{1\leq i\leq N}$ based on $S(a_1, \cdots, a_N)$
\For{$1\leq i\leq N-1$}
\If{$c(i, a_i)$ and $c(i+1, a_{i+1})$ not continuous}
\State do bi-RRT from $c(i, a_i)$ to $c(i+1, a_{i+1})$ 
\State insert the undesirable motion between $c(i, a_i)$ and $c(i+1, a_{i+1})$
\EndIf
\EndFor
\EndFor
\State \Return $P$
    \end{algorithmic}  
\end{algorithm}



\section{TNTP Optimal Solver}\label{section:solution}
In this section, the non-redundant TNTP problem is effectively solved, and all optimal solutions are proven collectible. 


\subsection{Principle of Optimality}

We observe that if the state of an intermediate point is assigned, then the calculation of cost becomes two independent parts. Denote the sub-TNTP problem in a similar form with less number of variables $n<N$, 
\begin{equation}
S(j_p, \cdots, j_q) \triangleq [D(p, j_p), \cdots, D(q, j_q)], 1\leq p <q \leq N
\end{equation}
with the cost defined similar as Eqn.~(\ref{equ:cost}). 
Let point $i$ be assigned with state $S(i, a_i)$, then 
\begin{equation}
\begin{aligned}
&\mathop{\rm argmin}\limits_{[j_1, \cdots, j_{i-1}, j_{i+1}, \cdots, j_N]} g(S(j_1, \cdots, j_{i-1}, a_i, j_{i+1}, \cdots, j_N))\\
&~~= \mathop{\rm argmin}\limits_{[j_1, \cdots, j_{i-1}]} g(S(j_1, \cdots, j_{i-1}, a_i))\\
&~~~~~~~~~~+\mathop{\rm argmin}\limits_{[j_{i+1}, \cdots, j_N]} g(S(a_i, j_{i+1}, \cdots, j_N))-1
\end{aligned}
\end{equation}
Here the last term $-1$ appears because when the manipulator finishes covering the last point of the first sub-TNTP with configuration $D(i, a_i)$, it has actually entered the second sub-TNTP with configuration $D(i, a_i)$ without EE lift-off. 
Then we can see that an optimal solution to the non-redundant TNTP must contain an optimal solution to the sub-TNTP, which essentially satisfies the principle of optimality for dynamic programming (DP)~\cite{Bellman2013Dynamic}. 
This motivates us to encode a partly-solved solution by the state of their frontier point:  
Let the state of points be assigned from point $1$ to point $N$, we denote the \textit{frontier point} by the last assigned point. 
We group the problem states with the same cost and the same decision on the frontier point, 
\begin{equation}
G(i, a_i) = \{S(j_1, \cdots, j_{i-1}, a_i)|1\leq j_k \leq A_k, 1\leq k\leq i-1\}
\end{equation}

In the first stage, all possible states of point $1$ are collected, with sets $G(1, 1), \cdots, G(1, A_1)$ being obviously constructed with only one element in each set. 
In the $i(\geq 2)$-th stage, the state of point $1\sim(i-1)$ has been assigned and different solutions are collected. After the state of point $i$ is assigned and the cost is updated, all solutions are re-grouped by the state of point $i$. Only the least-cost solutions are still preserved for the subsequent iteration. 




\subsection{Greedy Strategy}\label{section:greedy}
Typically, a greedy search strategy performs significantly faster than dynamic programming since no back-tracking process is required. 
However, it might not guarantee global optimality (minimal cost). 
In this section we show that greedily choosing the continuous configurations preserves global optimality and completeness in collecting all optimal solutions. 
The global optimality is verified by observing that in the $i$-th stage, let there exist a state of point $i$ which is equal to $a_{i-1}$, 
\begin{equation}\label{equ:optimality}
\begin{aligned}
&\mathop{\rm argmin}\limits_{[j_i, \cdots, j_N]} g(S(a_1, \cdots, a_{i-1}, j_i, \cdots, j_N))\\
=&g(S(a_1, \cdots, a_{i-1})) - 1 + \mathop{\rm argmin}\limits_{[j_i, \cdots, j_N]} g(S(a_{i-1}, j_i, \cdots, j_N))\\
=&g(S(a_1, \cdots, a_{i-1})) - 1 \\
+& \left\{
\begin{aligned}
&\mathop{\rm argmin}\limits_{[j_{i+1}, \cdots, j_N]} g(S(a_{i-1}, a_{i-1}, j_{i+1}, \cdots, j_N))\\
&\mathop{\rm argmin}\limits_{[j_{i+1}, \cdots, j_N]} g(S(a_{i-1}, a_i, \cdots, j_N))+1, \mbox{ enforce }a_i\neq a_{i-1}
\end{aligned}\right.\\
=&g(S(a_1, \cdots, a_{i-1})) - 1 \\
+&\left\{
\begin{aligned}
	&\left\{
	\begin{aligned}
		&\mathop{\rm argmin}\limits_{[j_{i+2}, \cdots, j_N]} g(S(a_{i-1}, a_{i-1}, a_{i-1}, \cdots, j_N)), \mbox{ if } a_{i+1}=a_{i-1}\\
		&\mathop{\rm argmin}\limits_{[j_{i+2}, \cdots, j_N]} g(S(a_{i-1}, a_{i-1}, a_{i+1}, \cdots, j_N))+1, \mbox{ else }
	\end{aligned}
	\right.\\
	&\mathop{\rm argmin}\limits_{[j_{i+1}, \cdots, j_N]} g(S(a_{i-1}, a_i, \cdots, j_N))+1, \mbox{ enforce }a_i\neq a_{i-1}
\end{aligned}
\right.
\end{aligned}
\end{equation}
We know that if we assign $j_i = a_{i-1}$, the cost will be always no higher than assigning other states $j_i\neq a_{i-1}$ to point $i$, 
regardless of whether at the next stage point $(i+1)$ may have the same state as point $i$. 
Hence, when the next unassigned point has the same possible state as the frontier point, we can discard all other possible states and directly assign this one. 




Next, we show that no optimal solution is missed by the greedy choice of states. 
If the greedy strategy is not complete, that means an optimal solution contains one of the discarded states by the greedy selection of state, which will be 
proven retrievable by the collected optimal solutions. Continuing the deduction from Eqn.~(\ref{equ:optimality}), we have 
\begin{equation}
\begin{aligned}
&\cdots (\mbox{Eqn.}~(\ref{equ:optimality}))\\
=&g(S(a_1, \cdots, a_{i-1})) - 1 \\
+&\left\{
\begin{aligned}
	&\left\{
	\begin{aligned}
		&\mathop{\rm argmin}\limits_{[j_{i+2}, \cdots, j_N]} g(S(a_{i-1}, a_{i-1}, a_{i-1}, \cdots, j_N)), \mbox{ if } a_{i+1}=a_{i-1}\\
		&{\color{blue}\mathop{\rm argmin}\limits_{[j_{i+2}, \cdots, j_N]} g(S(a_{i-1}, a_{i-1}, a_{i+1}, \cdots, j_N))+1, \mbox{ else }}
	\end{aligned}
	\right.\\
  &\left\{
	\begin{aligned}
		&\mathop{\rm argmin}\limits_{[j_{i+2}, \cdots, j_N]} g(S(a_{i-1}, a_i, a_i\cdots, j_N))+1, \mbox{ if }a_{i+1}= a_i\\
		&{\color{red}\mathop{\rm argmin}\limits_{[j_{i+2}, \cdots, j_N]} g(S(a_{i-1}, a_i, a_{i+1}, \cdots, j_N))+2, \mbox{ else }}
	\end{aligned}
	\right.
\end{aligned}
\right.
\end{aligned}
\end{equation}
Note that the term written in red has a higher cost than the term written in blue, so a discarded state of the current point contributes to an optimal solution only when there exists the same state for the next point, and the algorithm assigns it to the next point at the next stage. 
However, the solutions are equivalent: when a point can be continuously visited together with either its previous point or its subsequent point, the two solutions are both optimal and can continuously transform from one to another by locally adjusting the point at which the EE departs the task-space path.
See Fig.~\ref{fig:equiv} for an illustration. 
Hence, all optimal solutions are proven collectible by a dynamic programming approach with the greedy utilisation of continuous manipulator configurations. 


\begin{figure}[t]
\centering
\includegraphics[width=0.48\textwidth]{figures/greedy}
\caption{Illustration of equivalent task-space tracking solutions. Given the $7$ discrete points sampled from a task-space curve, two sets of joint-space connected IK solutions are represented by green and blue dots. All solutions on the right consist of a continuous tracking motion with configurations represented by green, an undesirable motion denoted by a black broken line, and a continuous tracking motion represented by blue, and they are all optimal solutions. The greedy strategy will find the last solution as it will lazily choose the configurations in green until it is not trackable.}\label{fig:equiv}
\vspace{-0.5cm}
\end{figure}


\begin{figure*}[t]
\centering
\includegraphics[width=0.96\textwidth]{figures/case_study/comb_3}
\caption{Illustration of valid IK solutions along the task-space path. 
The coloured curves show the joint-space connectivity between configurations. }\label{fig:allpose}
\vspace{-0.5cm}
\end{figure*}
% Note that if the table 2 stays next to the double-column figure, we cannot use this vspace command. Check in the end. 

\section{Experiments}\label{section:experiments}
The proposed algorithm generates all optimal joint-space trajectories ensuring the task-space tracking of a given EE path and a minimum number of manipulator pose reconfigurations. Simulated and real-world experiments are presented in this section. 
In section~\ref{section:case_study}, the detailed explanation about a case study is presented, with valid manipulator IK configurations illustrated, showing the necessity of manipulator pose re-configuration. 
To the authors' knowledge, there has not been an efficient algorithm for task-space tracking when the manipulator cannot follow the pre-defined path, as such all discussions were taken for redundant manipulators. So in section~\ref{section:comparison} we compare the proposed algorithm with the commonly used approach of randomly selecting the next configuration when continuous tracking is impossible.
In section~\ref{section:realworld}, the proposed algorithm is tested on a real-world Universal Robots UR5 manipulator. 
An implementation in MATLAB has been open sourced:~\url{https://github.com/ZJUTongYang/minReconfigTaskSpaceTracking}. 



\begin{figure}[t]
\centering
\subfigure[]{
\includegraphics[width=0.14\textwidth]{figures/case_study/dotted_pose1_151}\label{fig:case_study:a}
}
\subfigure[]{
\includegraphics[width=0.14\textwidth]{figures/case_study/dotted_pose2_390}\label{fig:case_study:b}
}
\subfigure[]{
\includegraphics[width=0.14\textwidth]{figures/case_study/dotted_pose3_780}\label{fig:case_study:c}
}
\caption{Illustration of a task-space tracking where two manipulator reconfigurations are required. The three segments of the continuous task-space tracking process (EE poses) are marked by blue, golden, and red colour in order. The gray curves show the trace of EE during reconfiguration.}\label{fig:case_study}
\vspace{-0.5cm}
\end{figure}


\subsection{Case Study}\label{section:case_study}
\begin{figure}[t]
\centering
\subfigure[Case $1$]{
\includegraphics[width=0.21\textwidth]{figures/newcomparison/cut_new_example_1_left}
\includegraphics[width=0.21\textwidth]{figures/newcomparison/cut_new_example_1_right}
}
\subfigure[Case $2$]{
\includegraphics[width=0.21\textwidth]{figures/newcomparison/cut_new_example_2_left}
\includegraphics[width=0.21\textwidth]{figures/newcomparison/cut_new_example_2_right}
}
\subfigure[Case $3$]{
\includegraphics[width=0.21\textwidth]{figures/newcomparison/cut_new_example_3_left}
\includegraphics[width=0.21\textwidth]{figures/newcomparison/cut_new_example_3_right}
}
\subfigure[Case $4$]{
\includegraphics[width=0.21\textwidth]{figures/newcomparison/cut_new_example_4_left}
\includegraphics[width=0.21\textwidth]{figures/newcomparison/cut_new_example_4_right}
}
\caption{Illustration of simulated comparison tests. The trajectories shown in the figures are the optimal solutions generated by the proposed algorithm.}\label{fig:comparison}
\vspace{-0.5cm}
\end{figure}

A task-space tracking process is shown here as a case study of the proposed algorithm. 
The task-space path is generated by interpolating four EE waypoints. 
Some valid IK solutions are collected in Fig.~\ref{fig:allpose} for better illustration of this case study. 
For one of the optimal tracking solutions see Fig.~\ref{fig:case_study}. 
Obstacles in the environment are a ground plane and a sphere. 
Because the starting point of the task-space curve is near the ground, only one IK solution is valid (marked by green dots) so the manipulator would adopt it. 
However, after the manipulator is about to reach the third intermediate goal, the forearm will hit the spherical obstacle, so one pose reconfiguration is required. 
The last configuration of the first segment of tracking is shown in Fig.~\ref{fig:case_study:a}. 
By changing to a configuration like shown in Fig.~\ref{fig:case_study:b}, the forearm is lifted a little, above the wrist, which makes the EE visit the third intermediate goal. However, the forearm will still hit the spherical obstacle if it continues tracking, where another pose reconfiguration is required. 
See Fig.~\ref{fig:case_study:c}, by adjusting the configuration from shoulder-right to shoulder-left, the manipulator is able to finish the tracking task without colliding the spherical obstacle.
The reader is referred to our supplementary video to observe the full animation of this case study. 



\begin{figure}[t]
\centering
\subfigure[]{
\includegraphics[width=0.22\textwidth]{figures/realworld/realworld_scenario}\label{fig:realworld_illustration:a}
}
\subfigure[]{
\includegraphics[width=0.22\textwidth]{figures/realworld/simulated_scenario_2}\label{fig:realworld_illustration:b}
}
\caption{The real-world scenario and its corresponding simulated environment. }\label{fig:realworld_illustration}
\vspace{-0.5cm}
\end{figure}



\begin{figure*}[t]
\centering
\subfigure[]{
\includegraphics[width=0.18\textwidth]{figures/realworld/1}\label{fig:realworld_steps:a}
}
\subfigure[]{
\includegraphics[width=0.18\textwidth]{figures/realworld/2}\label{fig:realworld_steps:b}
}
\subfigure[]{
\includegraphics[width=0.18\textwidth]{figures/realworld/3}\label{fig:realworld_steps:c}
}
\subfigure[]{
\includegraphics[width=0.18\textwidth]{figures/realworld/4}\label{fig:realworld_steps:d}
}
\subfigure[]{
\includegraphics[width=0.18\textwidth]{figures/realworld/5}\label{fig:realworld_steps:e}
}
\caption{Video stills of the manipulator configurations during the real-world tests (refer to video for full sequence)}\label{fig:realworld_steps}
\vspace{-0.62cm}
\end{figure*}

\subsection{Comparison with Sampling-based Planners}\label{section:comparison}
All existing solvers for task-space tracking are locally calculating a joint-space admissible trajectory, and when there is locally no valid trajectory to continue tracking, a joint-space path planner (such as the RRT~\cite{Lavalle2006Planning} used in this work, as often employed in manipulator planning software such as the widely used  MoveIt!~\footnote{\url{https://moveit.ros.org/}} by the ROS research community, and the OPML~\footnote{\url{http://ompl.kavrakilab.org/}} it is based on underneath) is carried out, as such the selected IK solution for visiting the next task-space point is randomly chosen. 
For fair evaluation, we assume the random selection of the IK solution for visiting the first task-space point, and the algorithms will greedily choose the continuous IK solutions. 
When the manipulator has to perform a pose reconfiguration motion, the starting pose of the next segment of task-space tracking is again randomly assigned. 

An illustration of the test cases is shown in Fig.~\ref{fig:comparison}, whilst some relevant statistics are collected in Table~\ref{table:comparison}. 
``Num."  refers to the number of manipulator pose reconfigurations generated by the algorithms. 
For a fair evaluation of the performance of sampling-based planners in these settings, all possible assignments of IK configurations are enumerated, and the mean number of pose reconfigurations for all possible situations is collected as ``Mean.". 
The last column, ``Distribution of Reconf", reflects the exact histogram (frequency distribution) of the number of reconfigurations in the resulting paths generated by sampling-based planners. 



\begin{table*}[t]
\centering
\scriptsize
\caption{Simulation Results Versus Sampling-based Planners}\label{table:comparison}
\setlength\tabcolsep{3pt}
\begin{tabular}{c|c|c|c|c|c|c|c|c}
\hline
Case & Method & Num.$^1$ & Mean.$^2$ & Time$^3$ & Bounding Box  & Efficiency (T)$^4$ & Efficiency (J)$^5$ & Distribution of Reconf.\\
\hline
\hline
\multirow{6}*{case $1$} & ours (1/1$^6$) & $\mathbf{2}$ & \multirow{6}*{6.25} & \textbf{42.58s} & \makecell[c]{$\mathbf{0.89m^3}$\\(0.85m$\times$1.00m$\times$1.05m)} & 1.48m/$\mathbf{5.04m}$ & 6.30rad$^6$/$\mathbf{17.03rad^5}$/$\mathbf{19.18rad^6}$ & \multirow{6}*{\makecell[c]{chance of optimal: $1/256\approx0.39\%$\\
\begin{minipage}[b]{0.25\columnwidth}
		\centering
		\raisebox{-.0\height}{\includegraphics[width=\linewidth]{figures/newcomparison/barchart_1}}
	\end{minipage}
}}\\
\cline{2-3}\cline{5-8}
& random $1$ & $7$ & & 117.70s & \makecell[c]{1.51m$^3$\\(1.25m$\times$1.15m$\times$1.05m)} & 1.46m/14.29m & 6.14rad$^6$/47.08rad$^5$/51.53rad$^6$ & \\
\cline{2-3}\cline{5-8}
& random $2$ & $8$ & & 122.68s & \makecell[c]{1.31m$^3$\\(1.00m$\times$1.25m$\times$1.05m)} & 1.46m/13.62m & 6.12rad$^6$/49.07rad$^5$/54.86rad$^6$ & \\
\hline 
\multirow{8}*{case $2$} & \multirow{4}*{ours (2/5)} & \multirow{4}*{$\mathbf{1}$} & \multirow{8}*{9.96} & 44.06s & \makecell[c]{1.32m$^3$\\(1.15m$\times$1.35m$\times$0.85m)} & 2.66m/5.07m & 11.38rad$^6$/17.62rad$^5$/20.60rad$^6$ & \multirow{8}*{\makecell[c]{chance of optimal: $5/6541\approx0.08\%$\\
\begin{minipage}[b]{0.25\columnwidth}
		\centering
		\raisebox{-.0\height}{\includegraphics[width=\linewidth]{figures/newcomparison/barchart_2}}
	\end{minipage}
}}\\
\cline{5-8}
& & & & \textbf{39.06s} & \makecell[c]{1.67m$^3$\\(1.15m$\times$1.45m$\times$1.00m)} & 2.65m/4.52m & 11.47rad$^6$/$\mathbf{15.62rad^5}$/$\mathbf{17.49rad^6}$\\
\cline{2-3}\cline{5-8}
& random $3$ & $3$ & & 53.13s & \makecell[c]{$\mathbf{0.79m^3}$\\(1.05m$\times$1.25m$\times$0.60m)} & 2.63m/$\mathbf{3.71m}$ & 12.30rad$^6$/21.25rad$^5$/25.35rad$^6$ &  \\
\cline{2-3}\cline{5-8}
& random $4$ & $14$ & & 176.37s & \makecell[c]{1.81m$^3$\\(1.15m$\times$1.50m$\times$1.05m)}& 2.47m/17.69m & 11.69rad$^6$/70.55rad$^5$/74.57rad$^6$ & \\
\hline
\multirow{6}*{case $3$} & ours (1/1) & $\mathbf{1}$ & \multirow{6}*{5.10} & \textbf{47.14s} & \makecell[c]{$\mathbf{1.49m^3}$\\(1.10m$\times$1.35m$\times$1.00m)} & 2.66m/$\mathbf{4.79m}$ & 11.91rad$^6$/$\mathbf{18.86rad^5}$/$\mathbf{21.20rad^6}$ & \multirow{6}*{\makecell[c]{chance of optimal: $1/90\approx 1.11\%$\\
\begin{minipage}[b]{0.25\columnwidth}
		\centering
		\raisebox{-.0\height}{\includegraphics[width=\linewidth]{figures/newcomparison/barchart_3}}
	\end{minipage}
}}\\
\cline{2-3}\cline{5-8}
& random 5& 7 & & 120.30s & \makecell[c]{1.80m$^3$\\(1.20m$\times$1.50m$\times$1.00m)} & 2.58m/10.29m & 11.01rad$^6$/48.12rad$^5$/53.73rad$^6$ &\\
\cline{2-3}\cline{5-8}
& random 6& 4 & & 77.15s & \makecell[c]{1.50m$^3$\\(1.20m$\times$1.25m$\times$1.00m)}& 2.63m/5.93m & 11.33rad$^6$/30.86rad$^5$/34.24rad$^6$ &\\
\hline
\multirow{8}*{case 4} & \multirow{4}*{ours (2/2)} & \multirow{4}*{$\mathbf{1}$} & \multirow{8}*{13.74} & \textbf{38.05s} & \makecell[c]{$\mathbf{1.08m^3}$\\(1.10m$\times$1.40m$\times$0.70m)} & 2.54m/$\mathbf{2.80m}$ & 11.52rad$^6$/$\mathbf{15.22rad^5}$/18.15rad$^6$ & \multirow{8}*{\makecell[c]{chance of optimal: $2/6084964\approx 0.00\%$\\
\begin{minipage}[b]{0.25\columnwidth}
		\centering
		\raisebox{-.0\height}{\includegraphics[width=\linewidth]{figures/newcomparison/barchart_4}}
	\end{minipage}
}}\\
\cline{5-8}
& & & & 39.04s & \makecell[c]{1.68m$^3$\\(1.20m$\times$1.40m$\times$1.00m)} & 2.54m/4.34m & 12.60rad$^6$/15.62rad$^5$/$\mathbf{17.82rad^6}$\\
\cline{2-3}\cline{5-8}
& random 7 & 7 & & 147.49s & \makecell[c]{3.09m$^3$\\(1.90m$\times$1.55m$\times$1.05m)} & 2.49m/21.76m & 11.35rad$^6$/58.99rad$^5$/66.86rad$^6$\\
\cline{2-3}\cline{5-8}
& random 8 & 10 & & 215.92s & \makecell[c]{3.45m$^3$\\(1.90m$\times$1.65m$\times$1.10m)} & 2.47m/31.47m & 11.31rad$^6$/86.37rad$^5$/94.85rad$^6$
\\
\hline
\end{tabular}
\begin{tablenotes}[t]
\item $^1$ Number of reconfigurations. 
\item $^2$ Mean number of reconfigurations of all greedy solutions. 
\item $^3$ Excecution time. Constant joint velocity is assumed, hence shortest-length joint-space is the fastest motion. Ranges of execution time (including undesirable motions) are approximately (sampled for case 2 and 4 given the large population): (Case 1) 42.58s$\sim$157.67s, (Case 2) 39.06s$\sim$199.31s, (Case 3) 47.14s$\sim$120.30s, (Case 4) 38.05s$\sim$466.76s.
\item $^4$ Efficiency (T): task-space tracking path length / end-effector path length.
\item $^5$ Efficiency (J): joint-space tracking path length / the first $5$-dim joint-space path length / joint-space path length. 
\item $^6$ Not all optimal solutions are shown for brevity in each case. A / B: optimal solutions detailed /  total number of optimal solutions. 
\end{tablenotes}
\vspace{-0.5cm}
\end{table*}



Further metrics are also reported in the table for completeness. While the objective of this work is minimum lift-off task-space tracking trajectories, other criteria would also 
be of relevance when considering the tracking problem. %, and are included for completeness. 
There may be motions that contain slightly more reconfigurations but shorter travelling distance, such as the ``random 3"  result. 
Ultimately, a trade-off can be derived subject to other criteria, but that falls out of scope for this work. 

Taking  case $1$ as an example, there are $256$ different greedy assignments for the segments of continuous task-space motion, among which only one solution identifies with the 
optimal solution (with 2 reconfigurations). 
A cuboid workcell admitting this motion is of size ${\rm 0.89m^3}$ (``Bounding Box''), the length of task-space motion is ${\rm 5.04m}$, and the joint-space travelling distance is 
${\rm 19.18rad^6}$. 
The average number of reconfigurations is shown to be $6.25$. When looking at the binned histogram, there is around a $70\%$ chance the sampling-based planner will generate a solution with $5\sim7$ reconfigurations. 
The reader is referred to the supplementary video for further visualisations and comparatives during the resulting planning motions. Time-wise, the optimal tracker (``ours'') is invariably faster in all cases presented.

Note that it is not the focus of this work to exhaustively compare the performance of different joint-space planners that may be able to produce marginally better reconfiguration trajectory in relation to EE lift-off and task space continuity. It is apparent that without a mechanism to select globally optimal IK solutions to visit at the next iteration along the path, solutions based on traditional sampling-based planners will inevitably lead to unnecessary manipulator reconfigurations regardless. In fact, examples in this work have shown a nearly $99\%$ certainty to obtain a non-optimal choice with traditional planners ( $1 - $ the probability of randomly attaining the optimal solution, shown in the last column in Table~\ref{table:comparison}).


\subsection{Real-world Illustration}\label{section:realworld}
The proposed algorithm is also evaluated in a real-world scenario. 
The real-world environment is modelled into MATLAB as shown in Fig.~\ref{fig:realworld_illustration}. Let the task-space path be a surface curve on the sphere. 
The $x$-axis of the EE is parallel to the surface normal vector, and the $y$-axis is parallel to the tangent of the surface curve, then $z$-axis is well-defined following the right-hand coordinates. As such the task is non-redundant for a $6$-Dof manipulator. The gripper imitates a non-zero length tool whose collision model is set as a cylinder (visualisation omitted in Fig.~\ref{fig:realworld_illustration:b} simulation). 
Fig.~\ref{fig:realworld_steps} captures the key moments, the reader is referred to the video for full visualisation. 
To pursue the optimal solution, the manipulator is instructed %by the proposed algorithm 
to start tracking with the configuration shown in Fig.~\ref{fig:realworld_steps:a}, and continuously track the task-space path until pose Fig.~\ref{fig:realworld_steps:b}, where the wrist is about to hit the forearm. 
One pose reconfiguration from a shoulder-right configuration (Fig.~\ref{fig:realworld_steps:b}) to a shoulder-left configuration (Fig.~\ref{fig:realworld_steps:d}) becomes necessary, the interim lift-off motion captured by Fig.~\ref{fig:realworld_steps:c}. 
The total execution time is 52s, where 18s, 29s, and 5s are used for the manipulator motion in the first segment, the undesirable reconfiguration, and the second and final segment of the tracking, respectively. 
The manipulator is thus guaranteed to be able to complete tracking of the desired path with only $1$ (optimal) pose reconfiguration. 

\section{Conclusion}\label{section:conclusion}
A novel mechanism to generate an optimal joint-space trajectory for the task-space non-revisiting tracking problem (TNTP) has been proposed in this work. 
The optimality is translated to the minimum number of segmentations of the pre-defined path caused by nonlinear manipulator kinematics and collision with obstacles in the environment. 
Manipulator reconfigurations are shown to be necessary for concatenating consecutive segments of continuous task-space tracking. These undesirable deviations generally result in additional time and energy penalties.
When compared to existing task-space tracking solutions, the proposed algorithm provides a globally optimal perspective to the choice of suitable manipulator inverse kinematics, 
maximising the joint-space connectedness during the tracking task. 
All optimal solutions (sequences of IK solutions ensuring minimal reconfigurations) are proven collected via a dynamic programming solver, where a proposed greedy speeding-up strategy is shown to be without loss of global optimality and completeness. 
Simulated comparisons and real-world illustration have proven the validity of the proposed algorithm, with substantial reconfigurability and resulting trajectory execution time improvements. 
These have been supplemented by a detailed video and an open source implementation in MATLAB for the research community benefit. 

On a side note we like to observe that the proposed algorithm calculates a ``joint-space" cost for a given task-space path. 
It is argued that a metric based on the simple summations of joint-space distance between consecutive valid IK configurations is not always an 
appropriate cost measurement, as reconfigurations can significantly influence tracking performance, and cannot be overlooked in applications where accuracy might be critical. 
In contrast, the proposed algorithm, with a minimum number of manipulator reconfigurations being explicitly considered, builds a more realistic estimation of task-space tracking cost, which might be inspirational to the community for other works. 


%\addtolength{\textheight}{-12cm}   % This command serves to balance the column lengths

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliographystyle{ieeetr} %% setting the cite style
\bibliography{RAL22}

\newpage



\end{document}
